<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/default}">
      <!-- layout:decorate 레이아웃 참고 -->


	<th:block layout:fragment="customTitle">
		<title>부품목록</title>
	</th:block>
	<th:block layout:fragment="customContents">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
		<script type="text/javascript">
			$(document).ready(function(){
				//var checkArray = [];
				var checkVal;
				//체크박스클릭시 
				$('input[name=partCheck]').click(function(){
					//경고창 초기화
					$('.card-body').find('h2').empty();

					var partCheck = $('input[name=partCheck]:checked');
					
										if(partCheck.length > 1){
						$('#buyPartBtn').text('다중부품구매');
						//$('[name=partListForm]').attr('action','/partGroupToOrder');
					}
				});
				//모든버튼클릭시
				$('.btn-info').click(function(){
					console.log('click');
					var partCheck = $('input[name=partCheck]:checked');
					console.log(partCheck);
	
					if(partCheck.length == 0){
						$('.card-body').find('h2').empty();
						$('.card-body').append('<h2>체크값을확인하여주세요</h2>');
					}else{
						$('.btn-info').attr('type','submit');
					}
				});	
				//구매버튼클릭시	
				$('#buyPartBtn').click(function(){
					var partCheck = $('input[name=partCheck]:checked');
					var length = partCheck.length;
					//console.log(checkVal+"<담긴배열값");
				//체크리스트담기을 값 화인
					partCheck.each(function() {
						if(checkVal == ""){
							checkVal = $(this).val();
						}else{
							checkVal += ','+$(this).val(); 
						}
							console.log("벨류값확인 : >>" + checkVal);
					});
					
					var form = $('[name=partListForm]');
					if(length==1){
						//1주문시
						form.attr('action','/partListToOrder?'+partCheck+'');
					}else{
						//2개이상주문시 배열
						$('.btn-info').attr('type','button');
						//배열에담기
						//checkArray.push(partCheck);
						
						var request = $.ajax({
							url: "/checkGroup",
							method: "POST",
							data: { 'checkArray' : checkVal },
							dataType: "json"
						});
						
						request.done(function( data ) {
							console.log(data);
						
						});
						
						request.fail(function( jqXHR, textStatus ) {
							console.log( "Request failed: " + textStatus );
						});	 					
					};
				});
			});
		</script>
		<div class="animated fadeIn">
			<div class="row">
				<div class="col-md-12">
					<div class="card">
						<div class="card-header">
							<strong class="card-title">부품목록</strong>
						</div>
						<div class="card-body">
							<form th:action="@{/partEstimateToList(partCheck)}" name="partListForm">
								<table style="font-size: 12px;" class="table table-striped table-bordered" id="bootstrap-data-table" border="1">
									<tr>
										<td>파트번호</td>
										<td>대분류</td>
										<td>중분류</td>
										<td>제품명</td>
										<td>개수</td>
										<td>판매가격</td>
										<td>등록자</td>
										<td>업데이트일자</td>
									</tr>
									<tr th:each=p:${partList}>
										<td><input type="checkbox" th:text="${p.partNumber}" th:value="${p.partNumber}" name="partCheck"></td>
										<td th:text="${p.bigCate}" th:value="${p.bigCate}"></td>
										<td th:text="${p.midCate}" th:value="${p.midCate}"></td>
										<td th:text="${p.partName}" th:value="${p.partName}"></td>
										<td th:text="${p.partMany}" th:value="${p.partMany}"></td>
										<td th:text="${p.partPrice}" th:value="${p.partPrice}"></td>
										<td th:text="${p.partWrite}" th:value="${p.partWrite}"></td>
										<td th:text="${p.partUpdateDate}" th:value="${p.partUpdateDate}"></td>
									</tr>
								</table>
								<button class="btn-info" type="button" id="sellPartBtn">부품불출</button>
								<button class="btn-info" type="button" id="buyPartBtn">부품구매</button>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	</th:block>
<<<<<<< HEAD
>>>>>>> refs/heads/pyw
=======

<th:block layout:fragment="customTitle">
	<title>부품목록</title>
</th:block>
<th:block layout:fragment="customContents">

<div class="animated fadeIn">
	<div class="row">
		<div class="col-md-12">
			<div class="card">
				<div class="card-header">
					<strong class="card-title">부품목록</strong>
				</div>
				<div class="card-body">
					<form th:action="@{/partEstimate(partCheck)}">
						<table style="font-size: 12px;" class="table table-striped table-bordered" id="bootstrap-data-table" border="1">
							<tr>
								<td>파트번호</td>
								<td>대분류</td>
								<td>중분류</td>
								<td>제품명</td>
								<td>개수</td>
								<td>판매가격</td>
								<td>등록자</td>
								<td>업데이트일자</td>
								<td>구매하기</td>
							</tr>
							<tr th:each=p:${partList}>
								<td><input type="checkbox" th:text="${p.partNumber}" th:value="${p.partNumber}" name="partCheck"></td>
								<td th:text="${p.bigCate}" th:value="${p.bigCate}"></td>
								<td th:text="${p.midCate}" th:value="${p.midCate}"></td>
								<td th:text="${p.partName}" th:value="${p.partName}"></td>
								<td th:text="${p.partMany}" th:value="${p.partMany}"></td>
								<td th:text="${p.partPrice}" th:value="${p.partPrice}"></td>
								<td th:text="${p.partWrite}" th:value="${p.partWrite}"></td>
								<td th:text="${p.partUpdateDate}" th:value="${p.partUpdateDate}"></td>
								<td><a th:href="@{/partOrderToList(partNumber=${p.partNumber})}">구매</a></td>
							</tr>
						</table>
						<button type="submit">부품불출</button>
					</form>
				</div>
			</div>
		</div>
	</div>
</div>
</th:block>

>>>>>>> refs/heads/cyj
</html>